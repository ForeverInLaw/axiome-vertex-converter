# Axiome Vertex Converter Bot üöÄ

Telegram-–±–æ—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –Ω–∞ Axiome –±–ª–æ–∫—á–µ–π–Ω–µ. Production-ready —Ä–µ—à–µ–Ω–∏–µ —Å enterprise-grade –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤
- üìπ **–í–∏–¥–µ–æ:** MP4, AVI, MKV, MOV, WEBM, FLV
- üéµ **–ê—É–¥–∏–æ:** MP3, WAV, FLAC, AAC, OGG, M4A
- üñº **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** JPG, PNG, WEBP, GIF, BMP, TIFF
- üìÑ **–î–æ–∫—É–º–µ–Ω—Ç—ã:** PDF, DOCX, TXT, MD

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üíæ **–°–∂–∞—Ç–∏–µ —Å –≤—ã–±–æ—Ä–æ–º –∫–∞—á–µ—Å—Ç–≤–∞** (–≤—ã—Å–æ–∫–æ–µ/—Å—Ä–µ–¥–Ω–µ–µ/–Ω–∏–∑–∫–æ–µ)
- üì¶ **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –¥–æ 10 —Ñ–∞–π–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ media groups
- ‚ö° **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è** - –¥–æ 3 —Ñ–∞–π–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- üìä **Progress tracking** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üíø **Disk monitoring** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –ø–µ—Ä–µ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π

## üí∞ –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è

| –ü–ª–∞–Ω | –õ–∏–º–∏—Ç—ã | –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä | –¶–µ–Ω–∞ |
|------|--------|--------------|------|
| **FREE** | 3 –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏/–¥–µ–Ω—å | 20 –ú–ë | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ |
| **PRO** | 100 –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π/–¥–µ–Ω—å | 200 –ú–ë | 50 AXM/30 –¥–Ω–µ–π |
| **ADMIN** üëë | –ë–µ–∑–ª–∏–º–∏—Ç–Ω–æ | 200 –ú–ë | –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 0: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å pnpm (–µ—Å–ª–∏ –Ω–µ—Ç)

```bash
npm install -g pnpm
```

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: `/newbot`
3. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ username
4. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω** (—Ñ–æ—Ä–º–∞—Ç: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:
```env
# –í—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –æ—Ç BotFather
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz

# –ê–¥–º–∏–Ω—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
ADMIN_USER_IDS=123456789,987654321

# –£–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ Axiome
AXIOME_WALLET_ADDRESS=axm1your_actual_wallet_address

# –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ë–î –Ω–∞ –Ω–∞–¥–µ–∂–Ω—ã–π
DB_PASSWORD=YourStrongPassword123!
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
pnpm install

# –ò–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –±–æ—Ç–∞
cd bot
pnpm install
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç—å

```bash
docker compose up -d
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker compose ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose logs -f bot
```

### –®–∞–≥ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–π —Ñ–∞–π–ª
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∏ –∫–∞—á–µ—Å—Ç–≤–æ
5. –ü–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üéâ

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
axiome-vertex-converter/
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ main.js                    # Entry point
‚îÇ   ‚îú‚îÄ‚îÄ payment-verifier.js        # Blockchain payment validator
‚îÇ   ‚îú‚îÄ‚îÄ commands/                  # Bot commands (/start, /subscribe, /status, /help)
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fileHandler.js         # File upload & validation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ conversionHandler.js   # Format selection & conversion
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ batchHandler.js        # Batch processing (media groups)
‚îÇ   ‚îú‚îÄ‚îÄ converters/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ videoConverter.js      # FFmpeg video conversion
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ audioConverter.js      # FFmpeg audio conversion
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ imageConverter.js      # Sharp image conversion
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ documentConverter.js   # LibreOffice document conversion
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.js            # PostgreSQL connection pool
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ limiter.js             # Rate limiting
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cleanup.js             # Auto file deletion
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ diskMonitor.js         # Disk space monitoring
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/                 # Inline keyboards (menu, format, quality)
‚îÇ   ‚îî‚îÄ‚îÄ i18n/                      # Internationalization (RU/EN)
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îú‚îÄ‚îÄ init.sql                   # Database schema with triggers
‚îÇ   ‚îî‚îÄ‚îÄ data/                      # PostgreSQL volume
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ PRD.md                     # Product Requirements Document
‚îÇ   ‚îî‚îÄ‚îÄ CODE_REVIEW.md             # Code review and security audit
‚îú‚îÄ‚îÄ compose.yml                    # Docker Compose configuration
‚îú‚îÄ‚îÄ .env                           # Environment variables (create from .env.example)
‚îî‚îÄ‚îÄ README.md                      # This file
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
- `/subscribe` - –û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- `/status` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
- `/help` - –°–ø—Ä–∞–≤–∫–∞

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**Enterprise-grade security:**
- ‚úÖ **File validation** - Magic numbers —á–µ—Ä–µ–∑ file-type
- ‚úÖ **Path traversal protection** - –ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Ç–µ–π
- ‚úÖ **SQL injection protection** - –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ **Rate limiting** - 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- ‚úÖ **FFmpeg sanitization** - –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
- ‚úÖ **Docker security** - Non-root user, no-new-privileges
- ‚úÖ **Network isolation** - Internal-only networking
- ‚úÖ **Auto-cleanup** - –§–∞–π–ª—ã —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç
- ‚úÖ **Disk monitoring** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- ‚úÖ **Token security** - –ù–∏–∫–∞–∫–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ª–æ–≥–∞—Ö

## üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
docker compose stop

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞
docker compose start

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker compose restart

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose logs -f bot

# –û–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞
docker compose down
docker compose build --no-cache
docker compose up -d
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–±–µ–∑ Docker)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd bot
pnpm install

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ
pnpm start

# –ò–ª–∏ –≤ dev —Ä–µ–∂–∏–º–µ
cd ..
pnpm run dev
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose ps

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
docker exec -it converter_db psql -U botuser -d converter_bot

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
SELECT COUNT(*) FROM users;                  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
SELECT COUNT(*) FROM conversions;           # –í—Å–µ–≥–æ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π
SELECT SUM(amount_axm) FROM transactions;   # –ü–æ–ª—É—á–µ–Ω–æ AXM

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
docker exec converter_bot df -h /usr/src/app/bot/temp

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FFmpeg
docker exec converter_bot ffmpeg -version
```

### –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø:**
```bash
docker exec converter_db pg_dump -U botuser converter_bot > backup_$(date +%Y%m%d).sql
```

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞:**
```bash
cat backup_20251108.sql | docker exec -i converter_db psql -U botuser -d converter_bot
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø (cron):**
```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ crontab (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00)
0 2 * * * cd /path/to/axiome-vertex-converter && docker exec converter_db pg_dump -U botuser converter_bot > backups/db_$(date +\%Y\%m\%d).sql
```

## üëë Admin Access

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç **–±–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø** –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏:

**1. –ü–æ–ª—É—á–∏—Ç–µ Telegram User ID:**
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É ‚Üí –Ω–∞–π–¥–∏—Ç–µ ID –≤ –ª–æ–≥–∞—Ö
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [@userinfobot](https://t.me/userinfobot)

**2. –î–æ–±–∞–≤—å—Ç–µ –≤ .env:**
```env
# –û–¥–∏–Ω –∞–¥–º–∏–Ω
ADMIN_USER_IDS=123456789

# –ù–µ—Å–∫–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
ADMIN_USER_IDS=123456789,987654321,555666777
```

**3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:**
```bash
docker compose restart bot
docker compose logs bot | grep admin
```

**–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –∞–¥–º–∏–Ω–∞:**
- ‚úÖ Unlimited conversions
- ‚úÖ No rate limiting
- ‚úÖ 200 –ú–ë max file size
- ‚úÖ `/status` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "üëë ADMIN"

## üéØ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–û–¥–∏–Ω–æ—á–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:** 10-60 —Å–µ–∫ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞)
- **Batch –∏–∑ 3 —Ñ–∞–π–ª–æ–≤:** 3x –±—ã—Å—Ç—Ä–µ–µ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- **Batch –∏–∑ 10 —Ñ–∞–π–ª–æ–≤:** 2x –±—ã—Å—Ç—Ä–µ–µ (3+3+3+1 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
- **Memory:** ~100-500MB –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é (FFmpeg)
- **Disk:** 2x —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ
- **Cleanup:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç

## ü§ù Contributing

Issues –∏ pull requests –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è! –ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º PR:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ issues
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Ç–µ—Å—Ç—ã
3. –°–ª–µ–¥—É–π—Ç–µ code style –ø—Ä–æ–µ–∫—Ç–∞

## üìù License

MIT License - —Å–º. LICENSE file

## üí¨ Support

- **Issues:** –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

---

**Built with ‚ù§Ô∏è using Node.js, Grammy, PostgreSQL, FFmpeg, Sharp**
